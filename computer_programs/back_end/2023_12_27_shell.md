# shell

## 磁盘

### df

- df -Th 查看已分区文件系统

### du

### df 和 du 显示不一致原因

df输出的已使用空间，du是遍历整个文件系统，获取总的使用空间，二者不一致。真实可使用空间应该以du为准。df显示满了，写不进去新内容了。delete的文件，如果fd还在，df能正常统计，du不会统计。

1. 进程占用已删除文件的句柄，导致空间无法回收；
查看进程占用无效文件句柄，命令：lsof | grep delete。如果有，重启进程释放无效句柄。如果内核进程占用，这个办法查不到，还需具体分析。
2. 重复挂载问题。一个目录写入文件以后，用把新的disk挂载到该目录，原来的文件无法看到，但空间还是被占用；
用mount -bind 可以排查。如果是重复挂载，du ./bind_test 会显示真实的使用空间，找出其中比较大的目录或文件即可。

### fdisk

- fdisk -l 查看磁盘使用情况

## ssh

### 重启CentOS的ssh服务

- service sshd restart
