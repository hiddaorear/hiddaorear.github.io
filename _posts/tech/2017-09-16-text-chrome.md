---
layout: post
title:  文本之Chrome搜索
category: 技术
tags: [text]
keywords:  text Chrome
description:
---

##  文本之Chrome搜索

#### Saturday, 16  2017 September

![ChengBi](/../../assets/img/tech/2017/ChengBi_1.jpg)

### 避免搜索
搜索第一件事，是如何避免去搜索。搜索是不得已而为之的技巧，首先我要分析，问题是什么，即使到了搜索这一步，可以有的放矢的去搜索，可做狙击手，不用散弹枪。
自己写的代码，应当条理清晰，执行条件分明，语句执行来去有由。可以在大脑里思考一下，问题出在哪里。这个效率最高，但依赖经验，以及良好的思维习惯。
别人写的代码，需要去找到对应的开发。然而，我发现最好不要轻易找对应的同事，因为大家各自有事情在忙，你去找人家，造成对方思维中断，次数多了，对方会不厌其烦。如果问题低级，可能被对方打上标签，怎么这么简单的事情来问我。而同事找问题，因为代码是他写的，熟悉，找问题有针对性，可能一下子就找到了，此时正中心中烦，如此简单。事实上，在没有具体的信息的情况下，问题的边界，不会如此清晰，复杂度是不可同日而语。在种情况下，只能自己多花时间，定位问题，直到定位到自己十拿九稳的程度，方可以去找对方讨论。用QQ等通信工具，胜于人过去。人过去，对方需要立即中断答复。通信工具，可以等到对方空下来看到了，再处理。总而言之，自己多花时间，是一种处理问题的方式，也是一种礼貌。
前端开发一般不用关注后台的处理，只需要关注接口所给数据即可。但有模糊之处，比如初始化的值，如何设置？报错提示，是前端自己定义显示，还是使用后台返回的提示语？正是如此，当返回的提示信息不对的时候，第一不是去查后台返回的信息，而是确定这里是前端自己定义的提示，还是直接显示后台的提示语。

出问题，第一步是打开控制台，看报错信息。这是大家习惯，看到报错信息，点击，看到报错处的代码，断点，单步调试，看代码执行情况。能看到报错的情况，基本这样就找到问题所在，一般都是与DOM相关，例如没有这个DOM的情况没有加上判断，或者没有判断DOM是否加载完成，就直接使用DOM。一般会报错，没有属性，或者没有length，之类。

如何没有看到报错信息，这类问题，处理反而要多花功夫。所以写代码的时候，不要随意try，catch错误。让必要的报错暴露出来。如果没有报错，只能从对应的现象开始分析，与DOM相关，则可以使用Chrome的一些好用的功能。

#### DOM断点

如果DOM有变化，则可以使用Chrome的DOM断点，可以直接定位到修改DOM的代码，非常方便。

#### DOM事件

如果是监听事件，则可以可以使用Chrome查看，这个DOM上绑定的事件。这个功能并不好用，如果是很存粹的JavaScript，比较好处理。如果引入框架或函数库，就麻烦了。因为各种框架对事件处理思路，基本上是要自己做一套事件系统，而这个一般思路，就是把事件代理了。所以这个时候，你会看到，一个DOM上绑定了很多个事件。可以留意一下对应的文件名，找到来自自定义的文件，查看一下，如果顺利，也可以找到对应的代码。这也提示大家，平时写事件的时候，不要滥用事件代理，只在必要的时候使用，一个按钮就没有必要，但一列按钮就需要事件代理。
查看DOM事件有一个好处，就是旧代码可能也绑定了这个DOM的事件，并且阻止事件冒泡等，如果你新增一个绑定，则有时候会不生效，这个时候就百思不得其解。表象就是，有时候事件生效了，有时候没有生效。让人烦躁不已。所以写代码的时候要注意，事件绑定最好有惯用的class，或者id来绑定。调试代码起来，一目了然。

#### 堆栈

在控制台中打断点，刷新之后单步调试，很方便，也很有用。还有一个很有用信息，那就是堆栈，看函数调用栈，能看到代码的运行过程，追溯一下最初的调用，容易找到问题所在。当然，这里有一个小技巧，就是断点之后，里面变量可以console使用，这个无疑于一个简单修改代码的功能。

以上涉及JavaScript调试，如果是CSS调试，则没有上面技巧，当然兼容性问题除外。直接在Chrome控制台看，很直观。一般难一点的问题是，一个元素出现样式问题，不是元素本身导致的，而是他的父元素的样式影响到他了。这类问题，一般与display属性相关，或者overflow属性，这些会影响元素展示形式的属性，要谨慎使用。写CSS的时候，养成良好习惯，把这些属性写前面。

至于性能问题，这里暂不讨论，可以另写一篇。


### 文本搜索

如果以上办法都行不通，此时定位问题，只有一招，那就是搜索。CSS问题，搜索一般去搜索引擎去找。JavaScript问题，则需要在Chrome中搜索。
在搜索之前，我们稍微看到一下上面class与id，如果有id优先搜索id，其次搜索class。所以，此时，我们整理一下思路，预计一下后续的搜索关键词，逐个逐个来。不可以乱序，如果没有搜索到对应的代码，乱序之后需要重来，太浪费时间。
而搜索范围，从小到大。优先在此HTML文本中搜索，其次去全局搜索。这里没有什么技巧，耐心耐烦而已。已经是下下策了，别无他法。
现在JavaScript文件都是编译之后的，搜索定位问题，造成麻烦，此时找编译之后代码，还得猜测一下源码。
定位问题从小到大，替换文件，要从大到小。前段时间替换大量的文件，需要先粗略关键字搜索，看一下对应的目录，然后提取自己想要目录规则，再次搜索。


### 技巧
1. 断点跳过框架代码；
2. console输出颜色；
3. 断点跳转到函数；
4. 事件断点；
5. snippets功能，随时编写代码；
6. copy格式化数据；
7. console支持切换环境，切换到iframe中；with可以调试iframe中代码；
8. debugger接口可以辅助定位到函数；
9. 条件断点；
10. $0当前选中元素；
11. document.designMode = "on"


### 快捷键
1. c+p 定位文件；
2. c+shift+o 定位成员函数；





## 参考资料：
Chrome官方文档


Yvan say：前端开发中，定位问题，调试，要消耗很多时间。而非，编程是纯函数式，还是面向对象。而查找是定位问题中的第一步，也影响效率的第一步。一个问题不能定位到对应的代码，令人丧气，加班随之而来，精力徒然消耗，效率焉不能低。熟练在Chrome查找代码，很大程度上影响一个了一个前端程序员的效率。而代码是文本，搜索，定位问题，不外乎在是多个文件，寻找一个模式。以这个思路，我总结一下，开发中常用的一些办法。

为什么写成一个系列呢？

我好友常告诉我，很多时候遇到问题，不知道怎么使用搜索引擎。现在体会到其中烦恼了。还有就是，最近做项目，涉及很多陌生代码，需要在其中查找定位问题，发现及其麻烦，也需要总结一下。当然还有，我决心要把Mac作为日用的开发机了，公司电脑屏幕不太好，每天加班到地铁最后一趟，眼睛干涩，在电梯的光滑的金属门上，瞥见一双陌生的红眼，心里愕然。想不如此，得换一种方式开发。

最后，文本作为我们最相关的一种的数据结构，却也是我们陌生的数据结构。文字，代码，都是文本构成。web开发中常用的正则表达式，也是文本处理的利器，常用，而真正知其所以然的人，不多。
