---
layout: post
title:  HTLM5之Promises(1)
category: 技术
tags: [HTML5 JavaScript Promises]
keywords: JavaScript Promises
description: 
---

##### Tuesday, 21 April 2015

### HTLM5之Promises

![梵高](/../../assets/img/tech/2015/Wheat_Field_with_Crows.jpg)

> A promise is defined as an object that has a function as the value for the proprety `then`:

````javascript
then(fulfilledHandler, errorHandler, progressHandler);
````

> All aruguments are optional and non-function values are ignored.

> This functions should return a new promise that is fulfilled when the given `fulfilledHandler` or `errorHandler` callback is finished. This allows promise operations to be chained together. The value returned from the callback handler is the fulfillment value for the returned promise. If the callback throws an error, the returned promise will be moved to failed state.
--- CommonJS Promises/A

### 回调函数缺点

1. 回调函数通常写成函数参数的形式，易形成“持续传递风格”（即参数是下一步操作，Continuation-passing-style）,导致函数输入和输出混乱，程序可读性差；
2. 回调函数通常仅能指定一个，如需多个操作，需改写回调函数；
3. 错误不易处理。

回调函数带来了一些工程上的问题。函数作为参数持续传递，易使逻辑高耦合，违背了“低耦合，高内聚”的设计。回调函数问题的本质是代码形式，回调函数的连续使用易形成“回调金字塔”，同时还有与之产生的回调函数的组织。

编程问题，通常可以通过增加中间层来解决。Promise对象就是这样一个合理的中间层，与回调函数密切相关的异步编程，可以在形式上线性编程，实质上异步执行。

ES6原生提供Promise对象。其代表了时间线上将要执行的操作。将异步操作以同步操作的流程表达，避免层层嵌套的回调函数。

Promise对象的使用：

````javascript

function timeout(ms) {
  return new Promsie((resolve) => {
    setTimeout(resolve, ms);
  });
}

timeout(100).then(() => {
  console.log('done);
});
````



### 参考资料
[You're Missing the Point of Promises](https://blog.domenic.me/youre-missing-the-point-of-promises/)
[JavaScript异步编程的Promise模式](http://www.infoq.com/cn/news/2011/09/js-promise)
[ES6 JavaScript Promise的感性认知 « 张鑫旭-鑫空间-鑫生活](http://www.zhangxinxu.com/wordpress/2014/02/es6-javascript-promise-%E6%84%9F%E6%80%A7%E8%AE%A4%E7%9F%A5/)
[Promise对象 -- JavaScript 标准参考教程](http://javascript.ruanyifeng.com/advanced/asynchronous.html#toc0)
[jQuery.Deferred对象 -- JavaScript 标准参考教程](http://javascript.ruanyifeng.com/jquery/deferred.html#toc0)
[Script Junkie | Understanding the Publish/Subscribe Pattern for Greater JavaScript Scalability](https://msdn.microsoft.com/en-us/magazine/hh201955.aspx)
[JS魔法堂: Native Promise Only源码剖析](http://www.cnblogs.com/fsjohnhuang/p/4293499.html)
[(译)深入理解Promise五部曲--1.异步问题](http://segmentfault.com/a/1190000000586666)

hid say: 
