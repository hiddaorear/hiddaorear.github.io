---
layout: post
title:  Mastering Regular Expression(4)
category: 技术
tags: [Regular Expression]
keywords: Regulaer expression 
description: 
---

##### Thursday, 09 April 2015

### 读《精通正则表达式》(四)

#### ---正则表达式优化技巧

![追逐繁星的孩子](/../../assets/img/tech/2015/children_who_chase_lost_voices_form_deep_below.jpg)

> 七十岁还能有这种天真的想法,愚不可及处,即为证明精神上还不像现在一些二十五以上的人消沉和世故.凡事天真会将带入困难,但同时会带入更光辉灿烂前景中去.世故和消沉等于停止等死.
从文家书·1972年8月14日

### Regex Balancing Act
1.只匹配期望的文本,排除不期望的文本;
2.如果使用NFA引擎,必须保证效率(尽可能快的匹配成功,或尽可能快的匹配失败);
3.必须易于控制和理解.

为了匹配效率和精确性,正则表达式的匹配边界很重要.匹配边界要能精确控制匹配,在应该回溯的情况下回溯,在无须回溯的情况下达到匹配的终点.为了达到这个目的,正则表达式中的量词十分重要,特别要谨慎使用'*'量词,因为'*'表示{0,n},没有匹配的情况也成立,在没有设定忽略优先的情况下,会匹配优先,这样会尽可能多的匹配.在NFA引擎,若没有使用固化分组和占有优先的情况下,会记录匹配的状态,以备回溯.

在匹配优先,忽略优先以及回溯的情况下,都不会影响需要检测路径本身,而只会影响到检测的顺序.但固化分组(?>...)和占有优先量词(?+,*?,++,{m,n}+),会导致放弃原来的某些可能路径.固化分组匹配结束时,他已经匹配的文本已经固化为一个单元,只能作为整体而保留或放弃,也就是其备用状态不存在,回溯永远野不能选择其中的状态.占有优先量词和匹配有限量词很相似,只是占有优先量词从来不交还已经匹配的字符.

回溯(backtracking)这个词,太熟悉了.有一个Linux系统就是用的这个名字,名字为`back|track-linux`,这个操作系统有一个很有意思的哲学,"The quieter you baecome, the more you are able to hear...".由回溯这个过程,我很容易就想起了JavaScript中的原型链结构,两者的核心都是维持在内存的中的一个链表结构.回溯所需要的状态是正则表达式前面的匹配产生并存储的状态,而JavaScipt的原型链是变量查找的对象链,从查找变量或状态的意义上看,两者的实质类似.

多选结构很影响匹配的效率,在很多NFA引擎中,多选结构优先匹配排在前面的子表达式.

正则表达式理论的经典的计算机科学教学文本,为传说中的恐龙书,Aho,Sethi,Ullman的Compilers--Principles,Techniques,and Tools的第三章.

### 参考资料
[编译原理 (豆瓣)](http://book.douban.com/subject/3296317/)

hid say:内功很重要.


